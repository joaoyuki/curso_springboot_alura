<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>SecurityConfiguration.class</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  
    <script type="text/javascript">
        function in_frame () { try { return window.self !== window.top; } catch (e) { return true; } }
        if (!in_frame()) {
            var page = location.pathname.substring(location.pathname.lastIndexOf("/") + 1);
            window.location = 'index.html#' + page;
        }
    </script>
</head>
<body><div class="page"><h1 class="title">SecurityConfiguration.class</h1><br/>/*<br /> * To change this license header, choose License Headers in Project Properties.<br /> * To change this template file, choose Tools | Templates<br /> * and open the template in the editor.<br /> */<br />package br.com.alura.forum.config.security;<br /><br />import org.springframework.beans.factory.annotation.Autowired;<br />import org.springframework.context.annotation.Configuration;<br />import org.springframework.http.HttpMethod;<br />import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;<br />import org.springframework.security.config.annotation.web.builders.HttpSecurity;<br />import org.springframework.security.config.annotation.web.builders.WebSecurity;<br />import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;<br />import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;<br />import org.springframework.security.config.http.SessionCreationPolicy;<br />import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;<br />import org.springframework.security.crypto.password.PasswordEncoder;<br /><br />/**<br /> *<br /> * @author João<br /> */<br /><br />@EnableWebSecurity // Habilita o módulo de segurança na aplicação<br />@Configuration // Indica que essa classe vai possuir configurações do Spring. Assim ao iniciar o projeto, o spring lê as configurações dessa classe<br />public class SecurityConfiguration extends WebSecurityConfigurerAdapter{<br /><br />    @Autowired<br />    private AutenticacaoService autenticacaoService;<br />    <br />    // Método que configura autenticação (controle de acesso/login)<br />    // new BCryptPasswordEncoder() é uma classe do spring que já implementa um hash para a senha usando o algorítmo BCrypt<br />    @Override<br />    protected void configure(AuthenticationManagerBuilder auth) throws Exception {<br />        auth.userDetailsService(autenticacaoService)<br />                .passwordEncoder(new BCryptPasswordEncoder())<br />                ;<br />    }<br /><br />    // Configurações de autorização (Quem pode acessar cada URL / perfil de acesso)<br />    @Override<br />    protected void configure(HttpSecurity http) throws Exception {<br />        http<br />            .authorizeRequests()<br />            .antMatchers(HttpMethod.GET, "/topicos").permitAll()<br />            .antMatchers(HttpMethod.GET, "/topicos/*").permitAll()<br />            .antMatchers(HttpMethod.POST, "/auth").permitAll()<br />            .anyRequest().authenticated()<br />            .and().csrf().disable()<br />            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)<br />                ;<br />    }<br /><br />    // Configurações de recursos estáticos (requisiçoes para arquivos js, css, imagens e etc...)<br />    @Override<br />    public void configure(WebSecurity web) throws Exception {<br />    }<br />    <br />    <br />    // Código para transformar uma senha qualquer em formato BCrypt<br />//    public static void main(String[] args) {<br />//        System.out.println(new BCryptPasswordEncoder().encode("123456"));<br />//    }<br />    <br />}<br /></div></body></html>